---
theme: seriph
title: 基于Microsoft Playwright MCP和大语言模型的网站自动化测试用例生成系统
info: 本科毕业设计开题报告
author: 陈阳
studentId: 229050810
date: 2025-09-16
transition: slide-left
class: text-center
highlighter: shiki
lineNumbers: true
---

# 基于Microsoft Playwright MCP和大语言模型的网站自动化测试用例生成系统

**本科毕业设计开题报告**

<div class="pt-12">
  <p>指导教师：吴敏</p>
  <p>学生：陈阳 (229050810)</p>
  <p>日期：2025年9月16日</p>
</div>

<!--
大家好，今天我将向大家汇报我的本科毕业设计课题——“基于Microsoft Playwright MCP和大语言模型的网站自动化测试用例生成系统”。本次汇报将围绕课题的背景意义、研究目标、核心内容、技术路线、预期成果以及项目的时间规划展开。
-->

---
layout: two-cols
---

# 1. 课题背景与意义

::left::

### 课题背景
- **测试困境**: 传统自动化测试脚本编写耗时、技术门槛高，难以跟上Web应用的快速迭代。
- **AI新机遇**: 大语言模型（LLM）在自然语言理解上取得突破，为“需求即测试”提供了可能。
- **技术前沿**: 微软推出Playwright MCP（Model-to-Context Protocol），为AI直接控制浏览器进行测试提供了标准协议。

::right::

### 课题意义
- **效率革命**: 将测试人员从繁琐的脚本编写中解放出来，实现从自然语言需求到可执行测试用例的自动转换。
- **降低门槛**: 大幅降低自动化测试的技术门槛，使业务人员也能参与测试用例的生成。
- **技术探索**: 探索并实践AI原生（AI-Native）开发与测试工具链，为下一代软件工程提供范例。
- **应用价值**: 为企业提供从需求到测试的无缝衔接方案，显著提升软件交付速度与质量。

<!--
首先我们來看一下课题的背景与意义。当前，Web应用越来越复杂，传统的自动化测试方法效率低下且成本高昂。与此同时，大语言模型和微软最新的Playwright MCP技术为我们提供了一个全新的思路——让AI能够理解需求文档，并直接控制浏览器进行测试。因此，本课题旨在打造一个能将需求直接变为测试用例的智能化系统，这无论在提升效率、降低门槛还是在前沿技术探索上，都具有非常重要的意义。
-->

---

# 2. 研究目标

设计并实现一个**将需求文档自动转化为Playwright测试代码的智能化系统**。

- **智能解析**: 系统能够自动解析Markdown或TXT格式的需求文档，提取关键测试流程。
- **MCP驱动**: 构建一个标准的MCP客户端，使大语言模型能通过该协议与浏览器稳定交互，执行测试动作。
- **代码生成**: 准确记录AI的操作序列，并将其自动转换为高质量、可读性强的Playwright TypeScript测试代码。
- **系统集成**: 提供一个用户友好的Web界面，实现从文档上传到代码导出的完整端到端体验。

<br>
<img src="https://user-images.githubusercontent.com/2277748/222452336-92a63516-7b2d-4825-9c8c-3c2a1b2f2b6e.png" alt="Workflow" class="rounded-lg shadow-lg mx-auto max-w-120"/>

<!--
本项目的核心研究目标，是设计并实现一个完整的智能化测试用例生成系统。这个系统需要具备四大核心能力：首先是能读懂需求文档；其次是能通过MCP协议，让AI像人一样去操作浏览器；然后是能把AI的操作过程自动录制并转换成高质量的测试代码；最后，我们会把所有功能集成在一个简单易用的Web界面里，提供一站式服务。
-->

---
layout: default
---

# 3. 系统架构设计

本系统采用“人-AI-浏览器”协同的架构，核心流程如下：

<div class="text-left text-sm space-y-2 bg-gray-100 p-4 rounded-lg">
<p><strong>1. 输入:</strong> 用户通过Web界面上传需求文档 (.md, .txt) 并指定测试网址</p>
<p class="ml-4">   &darr;</p>
<p><strong>2. 需求解析:</strong> Node.js后端解析文档，提取核心测试任务</p>
<p class="ml-4">   &darr;</p>
<p><strong>3. LLM驱动:</strong> 将测试任务和MCP工具集通过提示工程（Prompt）发送给大语言模型 (LLM)</p>
<p class="ml-4">   &darr;</p>
<p><strong>4. MCP交互:</strong> LLM决策并调用MCP工具 (如点击、输入)，MCP客户端执行浏览器操作</p>
<p class="ml-4">   &darr; <em>(AI实时操作浏览器，前端同步可视化)</em></p>
<p><strong>5. 操作记录与代码生成:</strong> 系统记录每一步成功的MCP调用，并实时转换为Playwright代码</p>
<p class="ml-4">   &darr;</p>
<p><strong>6. 输出:</strong> 在Web界面展示可执行的Playwright TypeScript代码，并支持一键导出</p>
</div>

<!--
这是我们设计的系统整体架构。用户在前端上传需求文档，后端服务会解析这个文档，然后将任务交给大语言模型。LLM会像一个智能的“指挥官”，通过MCP协议去命令浏览器执行点击、输入等操作。我们的系统会实时监控并记录下AI的每一步动作，最后将这些动作“翻译”成标准的Playwright代码，返还给用户。
-->

---
layout: two-cols
---

# 4. 主要研究内容 (1/3)

::left::

### 4.1 需求文档智能解析
研究并实现对特定格式（Markdown, TXT）需求文档的解析算法。
1.  **结构识别**: 识别文档中的标题、列表、表格等结构化信息。
2.  **意图提取**: 从自然语言描述中提取出关键测试实体，如功能模块、操作步骤（如“点击‘登录’按钮”）、输入数据和预期结果（如“页面应跳转到首页”）。
3.  **任务序列化**: 将提取出的信息转化为一个清晰、有序的测试任务序列，供后续LLM处理。

::right::

### 4.2 Playwright MCP集成与通信
实现一个稳定、高效的MCP客户端。
1.  **协议实现**: 遵循Microsoft官方MCP协议规范，实现客户端与Playwright MCP服务器的WebSocket长连接通信。
2.  **工具封装**: 将核心的Playwright操作（如`navigate`, `click`, `fill`, `screenshot`）封装为LLM可调用的工具函数。
3.  **状态同步**: 确保客户端能够准确获取浏览器状态（如页面URL、DOM元素）并返回给LLM，为AI决策提供依据。

<!--
我们的研究内容主要分为三个部分。第一部分是“读懂需求”，我们要让系统能自动从Markdown或TXT文档里，解析出要测什么、怎么测。第二部分是“连接AI与浏览器”，即实现一个标准的MCP客户端，把Playwright的各种浏览器操作，打包成一个个AI能理解和调用的“工具”，并确保它们之间的通信稳定可靠。
-->

---
layout: two-cols
---

# 5. 主要研究内容 (2/3)

::left::

### 4.3 LLM驱动的智能测试生成
设计高效的提示工程（Prompt Engineering）策略，引导LLM完成测试任务。
1.  **上下文构建**: 将解析后的测试任务、MCP工具集以及实时浏览器上下文信息，组合成一个高效的Prompt。
2.  **思维链 (CoT)**: 引导LLM进行逻辑思考，例如“首先我需要找到登录按钮，然后点击它，接着输入用户名和密码”。
3.  **决策与工具调用**: LLM根据思考链决策，选择最合适的MCP工具并生成调用请求。

::right::

### 4.4 操作序列到代码的转换
开发一个将MCP调用序列自动转换为Playwright代码的模块。
1.  **操作监听**: 监听并记录每一次LLM成功调用的MCP工具及其参数。
2.  **代码映射**: 将记录的工具调用（如`playwright_click(selector='#login')`）映射为对应的Playwright TypeScript代码（`await page.click('#login');`）。
3.  **代码优化**: 对生成的代码进行格式化、添加注释和必要的断言，确保代码的可读性和健壮性。

<!--
研究内容的第三部分是“指挥AI”，我们要设计一套高效的指令（Prompt），让LLM能够理解测试任务，并像人一样思考，一步步地调用工具去操作浏览器。第四部分是“翻译操作”，当AI完成操作后，我们需要一个模块，能把它的每一步动作都准确地记录下来，并自动“翻译”成符合Playwright最佳实践的、干净整洁的TypeScript代码。
-->

---

# 6. 主要研究内容 (3/3)

### 4.5 系统化与界面设计

设计并开发一个用户友好的Web界面，将所有功能集成，形成一套完整的端到端解决方案。

- **项目配置**: 支持用户输入待测试网站的URL、上传需求文档。
- **实时可视化**:
    - **AI思考过程**: 实时展示LLM的思考链（Chain of Thought）和决策过程。
    - **浏览器画面**: 嵌入一个浏览器操作的实时画面或截图流。
- **代码预览与导出**:
    - **实时生成**: 在AI操作的同时，同步生成并展示Playwright代码。
    - **一键复制/下载**: 提供便捷的代码导出功能。

<br>
<img src="https://github.com/microsoft/playwright-mcp/raw/main/docs/images/mcp-demo.gif" alt="UI-Demo" class="rounded-lg shadow-lg mx-auto max-w-140"/>

<!--
最后，为了让整个系统好用，我们需要一个用户界面。这个界面要能让用户轻松地上传文档、配置测试目标。最核心的是，在AI工作时，我们要能实时地看到它的“思考过程”和它正在操作的浏览器画面。同时，生成的代码也要实时显示在旁边，方便用户随时检查，并能一键复制或下载。
-->

---

# 7. 技术路线参考

<div class="grid grid-cols-2 gap-4">
<div>

- <i-carbon-code/> **后端服务**:
  - **框架**: Node.js + Express / Fastify
  - **语言**: TypeScript

- <i-carbon-cloud-satellite/> **MCP通信**:
  - `ws` (WebSocket 客户端)
  - Playwright MCP Server (官方提供)

- <i-carbon-microscope/> **AI 模型**:
  - **LLM**: Claude 3 / GPT-4 (支持工具调用)
  - **API**: Anthropic/OpenAI SDK

</div>
<div>

- <i-carbon-application-web/> **前端界面**:
  - **框架**: React / Vue.js
  - **UI库**: Ant Design / Element Plus

- <i-carbon-cics-program/> **代码生成**:
  - 自定义模板引擎或直接字符串拼接

- <i-carbon-container-services/> **部署**:
  - Docker

</div>
</div>

<!--
这是我们计划采用的技术栈。后端将主要使用Node.js和TypeScript，这与Playwright的技术栈保持一致。前端会选择React或Vue。核心的MCP通信会使用WebSocket库来构建客户端。AI部分，我们会接入支持工具调用的主流大模型，如Claude 3或GPT-4。最终，整个项目会通过Docker进行打包和部署，方便在不同环境中使用。
-->

---

# 8. 预期成果与技术指标

1.  **软件系统**
    - 一个功能完整的“基于Playwright MCP的自动化测试用例生成系统”Web应用。
    - 提供Docker镜像和详细的部署文档。

2.  **文档与图纸**
    - **毕业设计论文**: 详细阐述系统设计、核心技术与实验评估。
    - **系统设计说明书**: 包含系统架构图、MCP通信流程图、数据流图。
    - **用户使用手册**: 提供图文并茂的操作指南。

3.  **主要技术指标**
    - **文档解析准确率**: > 90%
    - **MCP工具调用成功率**: > 99%
    - **代码可执行率**: > 85% (对于常见Web场景)
    - **端到端效率**: < 3分钟 (对于5-10步的中等复杂度场景)

<!--
项目完成后，我们预期会交付一个可以实际运行的Web应用，并提供完整的源代码和部署文档。同时，会产出一系列设计文档和一份高质量的毕业论文。在技术指标上，我们追求在文档解析、工具调用、代码生成质量和系统整体效率上达到预设的高标准，例如对于一个中等复杂的测试场景，从上传需求到拿到代码，整个过程不超过3分钟。
-->

---

# 9. 起止日期及进度安排

**总体时间：2025-09-01 至 2025-12-31**

- **第一阶段 (2025.09.01 - 2025.09.30): 需求分析与技术预研**
  - 完成文献调研，深入理解Playwright MCP协议。
  - 搭建基础开发环境，完成技术选型验证。

- **第二阶段 (2025.10.01 - 2025.11.15): 核心模块开发**
  - 实现MCP客户端与LLM的集成。
  - 开发需求文档解析与代码生成模块。

- **第三阶段 (2025.11.16 - 2025.12.15): 系统集成与界面开发**
  - 开发Web前端界面，完成前后端联调。
  - 实现AI操作过程的可视化。

- **第四阶段 (2025.12.16 - 2025.12.31): 测试、优化与论文撰写**
  - 进行系统整体测试与性能优化。
  - 撰写毕业设计论文初稿。

<!--
最后是我们的项目进度安排。整个项目从9月1日持续到12月31日。我们会分为四个阶段：第一个月进行需求分析和技术预研；接下来的一个半月是核心后端模块的开发；然后一个月时间进行前后端集成和界面开发；最后在12月底完成系统测试和论文的初稿。
-->

---
class: text-center
---

# Q & A

**感谢聆听，欢迎各位老师提问**

<!--
我的汇报到此结束。感谢各位老师的聆听，欢迎大家提问与指导。
-->
